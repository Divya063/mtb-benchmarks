{"apiVersion":"kyverno.io/v1","items":[{"apiVersion":"kyverno.io/v1","kind":"ClusterPolicy","metadata":{"annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"kyverno.io/v1\",\"kind\":\"ClusterPolicy\",\"metadata\":{\"annotations\":{},\"name\":\"disallow-allow-privilege-escalation\"},\"spec\":{\"rules\":[{\"match\":{\"resources\":{\"kinds\":[\"Pod\"]}},\"name\":\"validate-allowPrivilegeEscalation\",\"validate\":{\"message\":\"Privileged mode is not allowed. Set allowPrivilegeEscalation to false\",\"pattern\":{\"spec\":{\"containers\":[{\"=(securityContext)\":{\"=(allowPrivilegeEscalation)\":false}}]}}}}],\"validationFailureAction\":\"enforce\"}}\n"},"creationTimestamp":"2022-04-28T07:37:59Z","generation":1,"name":"disallow-allow-privilege-escalation","resourceVersion":"1678","uid":"19af9fcd-4614-4ebf-a11c-f80d82f61417"},"spec":{"rules":[{"match":{"resources":{"kinds":["Pod"]}},"name":"validate-allowPrivilegeEscalation","validate":{"message":"Privileged mode is not allowed. Set allowPrivilegeEscalation to false","pattern":{"spec":{"containers":[{"=(securityContext)":{"=(allowPrivilegeEscalation)":false}}]}}}}],"validationFailureAction":"enforce"}},{"apiVersion":"kyverno.io/v1","kind":"ClusterPolicy","metadata":{"annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"kyverno.io/v1\",\"kind\":\"ClusterPolicy\",\"metadata\":{\"annotations\":{},\"name\":\"disallow-bind-mounts\"},\"spec\":{\"rules\":[{\"match\":{\"resources\":{\"kinds\":[\"Pod\"]}},\"name\":\"validate-hostPath\",\"validate\":{\"message\":\"Host path volumes are not allowed\",\"pattern\":{\"spec\":{\"=(volumes)\":[{\"X(hostPath)\":null}]}}}}],\"validationFailureAction\":\"enforce\"}}\n"},"creationTimestamp":"2022-04-28T07:37:59Z","generation":1,"name":"disallow-bind-mounts","resourceVersion":"1677","uid":"dd7260aa-3945-4427-9223-cdfd9ee6daad"},"spec":{"rules":[{"match":{"resources":{"kinds":["Pod"]}},"name":"validate-hostPath","validate":{"message":"Host path volumes are not allowed","pattern":{"spec":{"=(volumes)":[{"X(hostPath)":null}]}}}}],"validationFailureAction":"enforce"}},{"apiVersion":"kyverno.io/v1","kind":"ClusterPolicy","metadata":{"annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"kyverno.io/v1\",\"kind\":\"ClusterPolicy\",\"metadata\":{\"annotations\":{},\"name\":\"disallow-host-ipc\"},\"spec\":{\"rules\":[{\"match\":{\"resources\":{\"kinds\":[\"Pod\"]}},\"name\":\"validate-hostIPC\",\"validate\":{\"message\":\"Use of host IPC namespaces is not allowed\",\"pattern\":{\"spec\":{\"=(hostIPC)\":\"false\"}}}}],\"validationFailureAction\":\"enforce\"}}\n"},"creationTimestamp":"2022-04-28T07:37:59Z","generation":1,"name":"disallow-host-ipc","resourceVersion":"1684","uid":"248ada84-bce5-4a33-9f6d-6ab0204c396b"},"spec":{"rules":[{"match":{"resources":{"kinds":["Pod"]}},"name":"validate-hostIPC","validate":{"message":"Use of host IPC namespaces is not allowed","pattern":{"spec":{"=(hostIPC)":"false"}}}}],"validationFailureAction":"enforce"}},{"apiVersion":"kyverno.io/v1","kind":"ClusterPolicy","metadata":{"annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"kyverno.io/v1\",\"kind\":\"ClusterPolicy\",\"metadata\":{\"annotations\":{},\"name\":\"disallow-host-network-port\"},\"spec\":{\"rules\":[{\"match\":{\"resources\":{\"kinds\":[\"Pod\"]}},\"name\":\"validate-host-network\",\"validate\":{\"message\":\"Use of hostNetwork is not allowed\",\"pattern\":{\"spec\":{\"=(hostNetwork)\":false}}}},{\"match\":{\"resources\":{\"kinds\":[\"Pod\"]}},\"name\":\"validate-host-port\",\"validate\":{\"message\":\"Use of hostPort is not allowed\",\"pattern\":{\"spec\":{\"containers\":[{\"=(ports)\":[{\"X(hostPort)\":null}],\"name\":\"*\"}]}}}}],\"validationFailureAction\":\"enforce\"}}\n"},"creationTimestamp":"2022-04-28T07:37:59Z","generation":1,"name":"disallow-host-network-port","resourceVersion":"1683","uid":"d42ad472-fe5a-46bf-9dc1-3f5158538165"},"spec":{"rules":[{"match":{"resources":{"kinds":["Pod"]}},"name":"validate-host-network","validate":{"message":"Use of hostNetwork is not allowed","pattern":{"spec":{"=(hostNetwork)":false}}}},{"match":{"resources":{"kinds":["Pod"]}},"name":"validate-host-port","validate":{"message":"Use of hostPort is not allowed","pattern":{"spec":{"containers":[{"=(ports)":[{"X(hostPort)":null}],"name":"*"}]}}}}],"validationFailureAction":"enforce"}},{"apiVersion":"kyverno.io/v1","kind":"ClusterPolicy","metadata":{"annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"kyverno.io/v1\",\"kind\":\"ClusterPolicy\",\"metadata\":{\"annotations\":{},\"name\":\"disallow-host-pid\"},\"spec\":{\"rules\":[{\"match\":{\"resources\":{\"kinds\":[\"Pod\"]}},\"name\":\"validate-hostPID\",\"validate\":{\"message\":\"Use of host PID namespaces is not allowed\",\"pattern\":{\"spec\":{\"=(hostPID)\":\"false\"}}}}],\"validationFailureAction\":\"enforce\"}}\n"},"creationTimestamp":"2022-04-28T07:37:59Z","generation":1,"name":"disallow-host-pid","resourceVersion":"1682","uid":"9a0cef1c-6a01-4bbd-bb64-74b5a3d2c922"},"spec":{"rules":[{"match":{"resources":{"kinds":["Pod"]}},"name":"validate-hostPID","validate":{"message":"Use of host PID namespaces is not allowed","pattern":{"spec":{"=(hostPID)":"false"}}}}],"validationFailureAction":"enforce"}},{"apiVersion":"kyverno.io/v1","kind":"ClusterPolicy","metadata":{"annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"kyverno.io/v1\",\"kind\":\"ClusterPolicy\",\"metadata\":{\"annotations\":{\"pod-policies.kyverno.io/autogen-controllers\":\"none\"},\"name\":\"disallow-new-capabilities\"},\"spec\":{\"rules\":[{\"match\":{\"resources\":{\"kinds\":[\"Pod\"]}},\"name\":\"validate-add-capabilities\",\"validate\":{\"message\":\"New capabilities cannot be added\",\"pattern\":{\"spec\":{\"containers\":[{\"=(securityContext)\":{\"=(capabilities)\":{\"X(add)\":null}},\"name\":\"*\"}]}}}}],\"validationFailureAction\":\"enforce\"}}\n","pod-policies.kyverno.io/autogen-controllers":"none"},"creationTimestamp":"2022-04-28T07:37:59Z","generation":1,"name":"disallow-new-capabilities","resourceVersion":"1685","uid":"4032db0e-7372-4292-a369-cb72c5571997"},"spec":{"rules":[{"match":{"resources":{"kinds":["Pod"]}},"name":"validate-add-capabilities","validate":{"message":"New capabilities cannot be added","pattern":{"spec":{"containers":[{"=(securityContext)":{"=(capabilities)":{"X(add)":null}},"name":"*"}]}}}}],"validationFailureAction":"enforce"}},{"apiVersion":"kyverno.io/v1","kind":"ClusterPolicy","metadata":{"annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"kyverno.io/v1\",\"kind\":\"ClusterPolicy\",\"metadata\":{\"annotations\":{},\"name\":\"disallow-privileged\"},\"spec\":{\"rules\":[{\"match\":{\"resources\":{\"kinds\":[\"Pod\"]}},\"name\":\"validate-privileged\",\"validate\":{\"message\":\"Privileged mode is not allowed. Set privileged to false\",\"pattern\":{\"spec\":{\"containers\":[{\"=(securityContext)\":{\"=(allowPrivilegeEscalation)\":false,\"=(privileged)\":false}}]}}}}],\"validationFailureAction\":\"enforce\"}}\n"},"creationTimestamp":"2022-04-28T07:37:59Z","generation":1,"name":"disallow-privileged","resourceVersion":"1680","uid":"318fc6a9-04d6-4898-b5df-954666fc19cf"},"spec":{"rules":[{"match":{"resources":{"kinds":["Pod"]}},"name":"validate-privileged","validate":{"message":"Privileged mode is not allowed. Set privileged to false","pattern":{"spec":{"containers":[{"=(securityContext)":{"=(allowPrivilegeEscalation)":false,"=(privileged)":false}}]}}}}],"validationFailureAction":"enforce"}},{"apiVersion":"kyverno.io/v1","kind":"ClusterPolicy","metadata":{"annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"kyverno.io/v1\",\"kind\":\"ClusterPolicy\",\"metadata\":{\"annotations\":{},\"name\":\"disallow-root-user\"},\"spec\":{\"rules\":[{\"match\":{\"resources\":{\"kinds\":[\"Pod\"]}},\"name\":\"validate-runAsNonRoot\",\"validate\":{\"anyPattern\":[{\"spec\":{\"securityContext\":{\"runAsNonRoot\":true}}},{\"spec\":{\"securityContext\":{\"runAsUser\":\"\\u003e0\"}}},{\"spec\":{\"containers\":[{\"securityContext\":{\"runAsNonRoot\":true}}]}},{\"spec\":{\"containers\":[{\"securityContext\":{\"runAsUser\":\"\\u003e0\"}}]}}],\"message\":\"Running as root user is not allowed. Set runAsNonRoot to true\"}}],\"validationFailureAction\":\"enforce\"}}\n"},"creationTimestamp":"2022-04-28T07:37:59Z","generation":1,"name":"disallow-root-user","resourceVersion":"1679","uid":"c44af2c9-927d-4e5c-b755-d073616602e4"},"spec":{"rules":[{"match":{"resources":{"kinds":["Pod"]}},"name":"validate-runAsNonRoot","validate":{"anyPattern":[{"spec":{"securityContext":{"runAsNonRoot":true}}},{"spec":{"securityContext":{"runAsUser":"\u003e0"}}},{"spec":{"containers":[{"securityContext":{"runAsNonRoot":true}}]}},{"spec":{"containers":[{"securityContext":{"runAsUser":"\u003e0"}}]}}],"message":"Running as root user is not allowed. Set runAsNonRoot to true"}}],"validationFailureAction":"enforce"}},{"apiVersion":"kyverno.io/v1","kind":"ClusterPolicy","metadata":{"annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"kyverno.io/v1\",\"kind\":\"ClusterPolicy\",\"metadata\":{\"annotations\":{},\"name\":\"pvc-reclaim-policy-as-delete\"},\"spec\":{\"rules\":[{\"match\":{\"resources\":{\"kinds\":[\"PersistentVolume\"]}},\"name\":\"pvc-reclaim-policy-as-delete\",\"validate\":{\"message\":\"persistentVolumeReclaimPolicy should be Delete\",\"pattern\":{\"spec\":{\"=(persistentVolumeReclaimPolicy)\":\"Delete\"}}}}],\"validationFailureAction\":\"enforce\"}}\n"},"creationTimestamp":"2022-04-28T07:37:59Z","generation":1,"name":"pvc-reclaim-policy-as-delete","resourceVersion":"1687","uid":"3591a537-4548-417d-9f59-7aa27ac449b1"},"spec":{"rules":[{"match":{"resources":{"kinds":["PersistentVolume"]}},"name":"pvc-reclaim-policy-as-delete","validate":{"message":"persistentVolumeReclaimPolicy should be Delete","pattern":{"spec":{"=(persistentVolumeReclaimPolicy)":"Delete"}}}}],"validationFailureAction":"enforce"}},{"apiVersion":"kyverno.io/v1","kind":"ClusterPolicy","metadata":{"annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"kyverno.io/v1\",\"kind\":\"ClusterPolicy\",\"metadata\":{\"annotations\":{},\"name\":\"require-always-pull-image\"},\"spec\":{\"rules\":[{\"match\":{\"resources\":{\"kinds\":[\"Pod\"]}},\"name\":\"require-always-pull-image\",\"validate\":{\"message\":\"image pull policy should be Always\",\"pattern\":{\"spec\":{\"containers\":[{\"(name)\":\"*\",\"imagePullPolicy\":\"Always\"}]}}}}],\"validationFailureAction\":\"enforce\"}}\n"},"creationTimestamp":"2022-04-28T07:37:59Z","generation":1,"name":"require-always-pull-image","resourceVersion":"1686","uid":"dca0dc38-29ed-46d9-a527-6a5abb9c8bd0"},"spec":{"rules":[{"match":{"resources":{"kinds":["Pod"]}},"name":"require-always-pull-image","validate":{"message":"image pull policy should be Always","pattern":{"spec":{"containers":[{"(name)":"*","imagePullPolicy":"Always"}]}}}}],"validationFailureAction":"enforce"}},{"apiVersion":"kyverno.io/v1","kind":"ClusterPolicy","metadata":{"annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"kyverno.io/v1\",\"kind\":\"ClusterPolicy\",\"metadata\":{\"annotations\":{\"pod-policies.kyverno.io/autogen-controllers\":\"none\"},\"name\":\"restrict-nodeport\"},\"spec\":{\"rules\":[{\"match\":{\"resources\":{\"kinds\":[\"Service\"]}},\"name\":\"validate-nodeport\",\"validate\":{\"message\":\"Services of type NodePort are not allowed\",\"pattern\":{\"spec\":{\"type\":\"!NodePort\"}}}}],\"validationFailureAction\":\"enforce\"}}\n","pod-policies.kyverno.io/autogen-controllers":"none"},"creationTimestamp":"2022-04-28T07:37:59Z","generation":1,"name":"restrict-nodeport","resourceVersion":"1681","uid":"e9b687d9-4278-4fed-85d2-eec32be20636"},"spec":{"rules":[{"match":{"resources":{"kinds":["Service"]}},"name":"validate-nodeport","validate":{"message":"Services of type NodePort are not allowed","pattern":{"spec":{"type":"!NodePort"}}}}],"validationFailureAction":"enforce"}}],"kind":"ClusterPolicyList","metadata":{"continue":"","resourceVersion":"11462"}}
